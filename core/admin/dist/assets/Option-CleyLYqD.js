import{C as U}from"./Card-DCbDqfew.js";import{_ as S,b as o,e as a,p as y,d as v,q as c,F as p,g as i,t as n,s as d,v as g,l as j,h as m,w as u,k,f as w,y as f}from"./index-Be1QCY3O.js";const T={components:{Card:U},inject:["translate","apiBase","apiFetch","navTree","controls","getControl"],props:["sub"],data:()=>({slug:"options",postTypeFields:[],title:"",newSlug:"",status:"draft",obj:{}}),created(){this.init()},computed:{node(){const e=this.navTree?.find(l=>l.slug===this.slug);return this.sub&&e?.children?.find(l=>l.slug===this.sub)||e},isCreating(){return this.sub==="new"}},watch:{slug(){this.init()},sub(){this.init()}},methods:{async init(){this.postTypeFields=[{field:{parent_slug:this.slug,name:"Name",slug:"name",type:"text",revisions:!1,required:!0,priority:10,order:1e3},priority:10,source:"runtime"},{field:{parent_slug:this.slug,name:"Value",slug:"value",type:"text",revisions:!1,required:!1,priority:10,order:1100},priority:10,source:"runtime"},{field:{parent_slug:this.slug,name:"Auto load",slug:"autoload",type:"boolean",revisions:!1,required:!1,priority:10,order:1200},priority:10,source:"runtime"}],this.title="",this.newSlug="",this.status="draft",this.obj={},await Promise.all([this.getPost()]),this.isCreating&&(this.newSlug="")},async getPost(){if(!this.slug||this.isCreating)return;const e=await this.apiFetch(`${this.apiBase}/api/v1/${this.slug}/${this.sub}`);this.asign(await e.json())},async save(){try{if(this.obj?.id){const e=await this.apiFetch(`${this.apiBase}/api/v1/${this.slug}/${this.obj.id}`,{method:"PATCH",body:JSON.stringify({...this.obj,title:this.title,slug:this.newSlug})});this.asign(await e.json()),this.obj.slug&&this.obj.slug!==this.slug?this.$router.push("/settings/"+this.obj.slug):!this.obj.slug&&this.obj.id!==this.slug&&this.$router.push("/settings/"+this.obj.id)}else{const e=await this.apiFetch(`${this.apiBase}/api/v1/${this.slug}`,{method:"POST",body:JSON.stringify({title:this.title,slug:this.newSlug,...this.obj})});this.asign(await e.json()),this.$router.push("/settings/"+(this.obj.slug||this.obj.id))}}catch(e){console.error(e),alert(`Something went wrong: ${e.message}`)}},asign(e){this.newSlug=e.slug,this.title=e.title,this.obj=Object.fromEntries(Object.entries(e))}}},F={key:1,style:{padding:"20px 20px 50px"}},B={style:{margin:"0 0 20px"}},N={class:"wrapper"},P={class:"content"},O={key:0,class:"title"},q=["placeholder"],M={key:1,class:"slug"},L=["placeholder"],D={class:"permalink"},A={style:{width:"15px","margin-right":"5px"},xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 52 52","xml:space":"preserve"},E={class:"grid"},H={class:"fields"},J={class:"field"},G=["onUpdate:modelValue"],I=["onUpdate:modelValue"],z=["onUpdate:modelValue"],K=["onUpdate:modelValue"],Q=["onUpdate:modelValue"],R=["value"],W={key:6},X={class:"grid"},Y={class:"publish-row"},Z=["value"],x=["disabled"];function $(e,l,h,ee,te,s){const C=k("router-link"),b=k("card");return s.node?.vue_instance?(a(),o(p,{key:0},[h.sub&&s.navTree?(a(),y(c("drop-"+e.slug+"-"+h.sub),{key:0,slug:e.slug,sub:h.sub},null,8,["slug","sub"])):s.navTree?(a(),y(c("drop-"+e.slug),{key:1,slug:e.slug,sub:h.sub},null,8,["slug","sub"])):v("",!0)],64)):(a(),o("div",F,[i("h1",B,n(s.isCreating?s.translate("New"):s.translate("Update"))+" "+n(s.translate("setting")),1),i("div",N,[i("div",P,[e.postTypeFields?.find(t=>t.field.slug==="title")?(a(),o("div",O,[d(i("input",{placeholder:s.translate("Title"),"onUpdate:modelValue":l[0]||(l[0]=t=>e.title=t)},null,8,q),[[g,e.title]])])):v("",!0),e.postTypeFields?.find(t=>t.field.slug==="slug")?(a(),o("div",M,[d(i("input",{placeholder:s.translate("Slug"),"onUpdate:modelValue":l[1]||(l[1]=t=>e.newSlug=t)},null,8,L),[[g,e.newSlug]])])):v("",!0),i("div",D,[j(n(s.translate("Permalink"))+": ",1),l[6]||(l[6]=i("a",{href:"https://",target:"_blank"},"https://",-1))]),i("div",null,[m(C,{class:"button",to:"/settings"},{default:u(()=>[(a(),o("svg",A,[...l[7]||(l[7]=[i("path",{d:"M48.6 23H15.4c-.9 0-1.3-1.1-.7-1.7l9.6-9.6c.6-.6.6-1.5 0-2.1l-2.2-2.2c-.6-.6-1.5-.6-2.1 0L2.5 25c-.6.6-.6 1.5 0 2.1L20 44.6c.6.6 1.5.6 2.1 0l2.1-2.1c.6-.6.6-1.5 0-2.1l-9.6-9.6c-.6-.7-.2-1.8.7-1.8h33.2c.8 0 1.5-.6 1.5-1.4v-3c0-.8-.6-1.6-1.4-1.6"},null,-1)])])),j(" "+n(s.translate("Go back to"))+" "+n(s.translate("Settings")?.toLowerCase()),1)]),_:1})]),i("div",E,[m(b,null,{header:u(()=>[i("h2",null,n(s.translate("Fields")),1)]),footer:u(()=>[...l[8]||(l[8]=[])]),default:u(()=>[i("div",H,[(a(!0),o(p,null,w(e.postTypeFields?.filter(t=>!["slug","title","status"].includes(t.field.slug)),({field:t,priority:V,source:_})=>(a(),o("div",J,[i("label",null,n(s.translate(t.name))+" "+n(t.required?"*":""),1),t.type==="text"?d((a(),o("input",{key:0,"onUpdate:modelValue":r=>e.obj[t.slug]=r},null,8,G)),[[g,e.obj[t.slug]]]):t.type==="number"?d((a(),o("input",{key:1,type:"number","onUpdate:modelValue":r=>e.obj[t.slug]=r},null,8,I)),[[g,e.obj[t.slug]]]):t.type==="editor"?d((a(),o("textarea",{key:2,"onUpdate:modelValue":r=>e.obj[t.slug]=r},null,8,z)),[[g,e.obj[t.slug]]]):t.type==="textarea"?d((a(),o("textarea",{key:3,"onUpdate:modelValue":r=>e.obj[t.slug]=r},null,8,K)),[[g,e.obj[t.slug]]]):t.type==="select"?d((a(),o("select",{key:4,"onUpdate:modelValue":r=>e.obj[t.slug]=r},[(a(!0),o(p,null,w(t.options?.choices,r=>(a(),o("option",{value:r},n(r),9,R))),256))],8,Q)),[[f,e.obj[t.slug]]]):s.controls?.find(r=>r.slug===t.type)?(a(),y(c(s.getControl(t.type)),{key:5,large:!0,postType:e.slug,modelValue:e.obj[t.slug],"onUpdate:modelValue":r=>e.obj[t.slug]=r,field:t,priority:V,source:_,item:e.obj},null,8,["postType","modelValue","onUpdate:modelValue","field","priority","source","item"])):(a(),o("div",W,"Unsupported field: "+n(t),1))]))),256))])]),_:1})])]),i("div",X,[m(b,null,{header:u(()=>[i("h2",null,n(s.translate("Publish")),1)]),footer:u(()=>[i("button",{disabled:s.isCreating,onClick:l[3]||(l[3]=t=>(e.status="trashed",s.save()))},n(s.translate("Move to trash")),9,x),s.isCreating?(a(),o("button",{key:0,onClick:l[4]||(l[4]=(...t)=>s.save&&s.save(...t))},n(s.translate("Create")),1)):(a(),o("button",{key:1,onClick:l[5]||(l[5]=(...t)=>s.save&&s.save(...t))},n(s.translate("Update")),1))]),default:u(()=>[i("div",Y,[l[9]||(l[9]=i("div",{class:"icon"},[i("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M9 6a3 3 0 0 1 3-3h0a3 3 0 0 1 3 3h0a3 3 0 0 1-3 3h0a3 3 0 0 1-3-3m3 3v12",style:{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"}})])],-1)),i("label",null,n(s.translate("Status"))+":",1),d(i("select",{"onUpdate:modelValue":l[2]||(l[2]=t=>e.status=t)},[(a(!0),o(p,null,w(e.postTypeFields?.find(t=>t.field.slug==="status")?.field?.options?.choices||[],t=>(a(),o("option",{value:t},n(t),9,Z))),256))],512),[[f,e.status]])])]),_:1}),m(b,null,{header:u(()=>[i("h2",null,n(s.translate("Categories")),1)]),footer:u(()=>[...l[10]||(l[10]=[])]),_:1})])])]))}const ie=S(T,[["render",$],["__scopeId","data-v-73adfe29"]]);export{ie as default};
