import{_ as P,b as l,e as u,g as o,d as w,t as m,h as g,w as b,k as S,z as x,s as h,v as _,r,o as B,A as R,B as C,l as y}from"./index-D7FsSaiF.js";const N={name:"ResetPassword",setup(){const f=R(),s=C(),n=r(""),e=r(""),a=r(""),c=r(!1),d=r(""),t=r(!1),i=r("");return B(()=>{i.value=f.query.token,i.value||(a.value="Invalid or missing reset token")}),{password:n,confirmPassword:e,error:a,success:c,successMessage:d,loading:t,handleSubmit:async()=>{if(a.value="",!i.value){a.value="Invalid or missing reset token";return}if(n.value!==e.value){a.value="Passwords do not match";return}if(n.value.length<8){a.value="Password must be at least 8 characters long";return}t.value=!0;try{const v=await fetch("/api/v1/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:i.value,password:n.value})}),k=await v.json();if(!v.ok)throw new Error(k.message||"Failed to reset password");c.value=!0,d.value="Password has been reset successfully! You can now log in with your new password.",setTimeout(()=>{s.push("/login")},3e3)}catch(p){a.value=p.message}finally{t.value=!1}}}}},V={class:"reset-password-container"},M={class:"reset-password-box"},T={key:0,class:"error-message"},q={key:1,class:"success-message"},E={class:"form-group"},I=["disabled"],j={class:"form-group"},D=["disabled"],L=["disabled"],O={class:"back-to-login"};function U(f,s,n,e,a,c){const d=S("router-link");return u(),l("div",V,[o("div",M,[s[7]||(s[7]=o("h1",null,"Reset Password",-1)),e.error?(u(),l("div",T,m(e.error),1)):w("",!0),e.success?(u(),l("div",q,[o("p",null,m(e.successMessage),1),g(d,{to:"/login",class:"login-link"},{default:b(()=>[...s[3]||(s[3]=[y("Go to Login",-1)])]),_:1})])):w("",!0),e.success?w("",!0):(u(),l("form",{key:2,onSubmit:s[2]||(s[2]=x((...t)=>e.handleSubmit&&e.handleSubmit(...t),["prevent"])),class:"reset-form"},[o("div",E,[s[4]||(s[4]=o("label",{for:"password"},"New Password",-1)),h(o("input",{id:"password","onUpdate:modelValue":s[0]||(s[0]=t=>e.password=t),type:"password",placeholder:"Enter your new password",required:"",minlength:"8",disabled:e.loading},null,8,I),[[_,e.password]])]),o("div",j,[s[5]||(s[5]=o("label",{for:"confirmPassword"},"Confirm Password",-1)),h(o("input",{id:"confirmPassword","onUpdate:modelValue":s[1]||(s[1]=t=>e.confirmPassword=t),type:"password",placeholder:"Confirm your new password",required:"",minlength:"8",disabled:e.loading},null,8,D),[[_,e.confirmPassword]])]),o("button",{type:"submit",disabled:e.loading,class:"submit-btn"},m(e.loading?"Resetting...":"Reset Password"),9,L)],32)),o("div",O,[g(d,{to:"/login"},{default:b(()=>[...s[6]||(s[6]=[y("Back to Login",-1)])]),_:1})])])])}const F=P(N,[["render",U],["__scopeId","data-v-814ee409"]]);export{F as default};
