import{C as V}from"./Card-BN6klPFZ.js";import{_ as x,b as n,e as i,p as g,d as y,q as p,F as c,g as a,t as r,s as h,v as m,l as w,h as b,w as d,k as j,T as U,f,y as T}from"./index-CNAAdVuX.js";const _={components:{Card:V},inject:["translate","apiBase","apiFetch","navTree","controls","getControl"],props:["slug","taxonomy","sub"],data:()=>({fileupload:!1,postType:null,postTypeFields:[],taxonomyItem:null,taxonomyFields:[],title:"",newSlug:"",status:"draft",obj:{}}),created(){this.init()},computed:{node(){const l=this.navTree?.find(o=>o.slug===this.slug)?.children?.find(o=>o.slug===`terms/${this.taxonomy}`);return this.sub&&l?.children?.find(o=>o.slug===this.sub)||l},isCreating(){return this.sub==="new"},featuredImage(){return this.taxonomyFields?.find(t=>t.field.slug==="featured_image"&&t.field.type==="media")}},watch:{slug(){this.init()},sub(){this.init()}},methods:{async init(){this.postType=null,this.postTypeFields=[],this.taxonomyItem=null,this.taxonomyFields=[],this.title="",this.newSlug="",this.status="draft",this.obj={},await Promise.all([this.getPostType(),this.getPostTypeFields(),this.getTaxonomy(),this.getTaxonomyFields(),this.getTerm()]),this.isCreating&&(this.newSlug="")},async getPostType(){const t=await this.apiFetch(`${this.apiBase}/api/v1/post-types/${this.slug}`);this.postType=await t.json()},async getPostTypeFields(){const t=await this.apiFetch(`${this.apiBase}/api/v1/${this.slug}/fields`);this.postTypeFields=await t.json(),typeof this.postTypeFields?.sort=="function"&&(this.postTypeFields=this.postTypeFields.sort((l,o)=>l.field.order-o.field.order))},async getTaxonomy(){const t=await this.apiFetch(`${this.apiBase}/api/v1/${this.slug}/taxonomies/${this.taxonomy}`);this.taxonomyItem=await t.json()},async getTaxonomyFields(){const t=await this.apiFetch(`${this.apiBase}/api/v1/${this.slug}/taxonomies/${this.taxonomy}/fields`);this.taxonomyFields=await t.json(),typeof this.taxonomyFields?.sort=="function"&&(this.taxonomyFields=this.taxonomyFields.sort((l,o)=>l.field.order-o.field.order))},async getTerm(){if(!this.slug||this.isCreating)return;const t=await this.apiFetch(`${this.apiBase}/api/v1/${this.slug}/terms/${this.taxonomy}/${this.sub}`);this.asign(await t.json())},async save(){try{if(this.obj?.id){const t=await this.apiFetch(`${this.apiBase}/api/v1/${this.slug}/terms/${this.taxonomy}/${this.obj.id}`,{method:"PATCH",body:JSON.stringify({...this.obj,title:this.title,slug:this.newSlug})});this.asign(await t.json()),this.obj.slug&&this.obj.slug!==this.slug?this.$router.push("/"+this.slug+"/terms/"+this.taxonomy+"/"+this.obj.slug):!this.obj.slug&&this.obj.id!==this.slug&&this.$router.push("/"+this.slug+"/terms/"+this.taxonomy+"/"+this.obj.id)}else{const t=await this.apiFetch(`${this.apiBase}/api/v1/${this.slug}/terms/${this.taxonomy}`,{method:"POST",body:JSON.stringify({title:this.title,slug:this.newSlug,...this.obj})});this.asign(await t.json()),this.$router.push("/"+this.slug+"/terms/"+this.taxonomy+"/"+(this.obj.slug||this.obj.id))}}catch(t){console.error(t),alert(`Something went wrong: ${t.message}`)}},asign(t){this.newSlug=t.slug,this.title=t.title,this.obj=Object.fromEntries(Object.entries(t))}}},B={key:1,style:{padding:"20px 20px 50px"}},S={style:{margin:"0 0 20px"}},I={class:"wrapper"},P={class:"content"},M={key:0,class:"title"},N=["placeholder"],O={key:1,class:"slug"},D=["placeholder"],L={class:"permalink"},q={style:{width:"15px","margin-right":"5px"},xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 52 52","xml:space":"preserve"},E={class:"grid"},H={class:"fields"},J={class:"field"},A=["onUpdate:modelValue"],G=["onUpdate:modelValue"],R=["onUpdate:modelValue"],z=["onUpdate:modelValue"],K=["onUpdate:modelValue"],Q=["value"],W={key:6},X={class:"grid"},Y={class:"publish-row"},Z=["value"],$={class:"publish-row"},tt=["disabled"],et=["disabled"];function st(t,l,o,lt,at,s){const k=j("router-link"),v=j("card");return s.node?.vue_instance?(i(),n(c,{key:0},[o.sub&&s.navTree?(i(),g(p("drop-"+o.slug+"-"+o.sub),{key:0,slug:o.slug,sub:o.sub},null,8,["slug","sub"])):s.navTree?(i(),g(p("drop-"+o.slug),{key:1,slug:o.slug,sub:o.sub},null,8,["slug","sub"])):y("",!0)],64)):(i(),n("div",B,[a("h1",S,r(s.isCreating?s.translate("New"):s.translate("Update"))+" "+r(s.node?.name_singular),1),a("div",I,[a("div",P,[t.taxonomyFields?.find(e=>e.field.slug==="title")?(i(),n("div",M,[h(a("input",{placeholder:s.translate("Title"),"onUpdate:modelValue":l[0]||(l[0]=e=>t.title=e)},null,8,N),[[m,t.title]])])):y("",!0),t.taxonomyFields?.find(e=>e.field.slug==="slug")?(i(),n("div",O,[h(a("input",{placeholder:s.translate("Slug"),"onUpdate:modelValue":l[1]||(l[1]=e=>t.newSlug=e)},null,8,D),[[m,t.newSlug]])])):y("",!0),a("div",L,[w(r(s.translate("Permalink"))+": ",1),l[8]||(l[8]=a("a",{href:"https://",target:"_blank"},"https://",-1))]),a("div",null,[b(k,{class:"button",to:"/"+o.slug+"/terms/"+o.taxonomy},{default:d(()=>[(i(),n("svg",q,[...l[9]||(l[9]=[a("path",{d:"M48.6 23H15.4c-.9 0-1.3-1.1-.7-1.7l9.6-9.6c.6-.6.6-1.5 0-2.1l-2.2-2.2c-.6-.6-1.5-.6-2.1 0L2.5 25c-.6.6-.6 1.5 0 2.1L20 44.6c.6.6 1.5.6 2.1 0l2.1-2.1c.6-.6.6-1.5 0-2.1l-9.6-9.6c-.6-.7-.2-1.8.7-1.8h33.2c.8 0 1.5-.6 1.5-1.4v-3c0-.8-.6-1.6-1.4-1.6"},null,-1)])])),w(" "+r(s.translate("Go back to"))+" "+r(s.translate(s.node?.name_plural)),1)]),_:1},8,["to"])]),a("div",E,[b(v,null,{header:d(()=>[a("h2",null,r(s.translate("Fields")),1)]),footer:d(()=>[...l[10]||(l[10]=[])]),default:d(()=>[a("div",H,[(i(!0),n(c,null,f(t.taxonomyFields?.filter(e=>!["slug","title","featured_image","status"].includes(e.field.slug)),({field:e,priority:F,source:C})=>(i(),n("div",J,[a("label",null,r(s.translate(e.name))+" "+r(e.required?"*":""),1),e.type==="text"?h((i(),n("input",{key:0,"onUpdate:modelValue":u=>t.obj[e.slug]=u},null,8,A)),[[m,t.obj[e.slug]]]):e.type==="number"?h((i(),n("input",{key:1,type:"number","onUpdate:modelValue":u=>t.obj[e.slug]=u},null,8,G)),[[m,t.obj[e.slug]]]):e.type==="editor"?h((i(),n("textarea",{key:2,"onUpdate:modelValue":u=>t.obj[e.slug]=u},null,8,R)),[[m,t.obj[e.slug]]]):e.type==="textarea"?h((i(),n("textarea",{key:3,"onUpdate:modelValue":u=>t.obj[e.slug]=u},null,8,z)),[[m,t.obj[e.slug]]]):e.type==="select"?h((i(),n("select",{key:4,"onUpdate:modelValue":u=>t.obj[e.slug]=u},[(i(!0),n(c,null,f(e.options?.choices,u=>(i(),n("option",{value:u},r(u),9,Q))),256))],8,K)),[[T,t.obj[e.slug]]]):s.controls?.find(u=>u.slug===e.type)?(i(),g(p(s.getControl(e.type)),{key:5,large:!0,postType:o.slug,modelValue:t.obj[e.slug],"onUpdate:modelValue":u=>t.obj[e.slug]=u,field:e,priority:F,source:C,item:t.obj},null,8,["postType","modelValue","onUpdate:modelValue","field","priority","source","item"])):(i(),n("div",W,"Unsupported field: "+r(e),1))]))),256))])]),_:1})])]),a("div",X,[b(v,null,{header:d(()=>[a("h2",null,r(s.translate("Publish")),1)]),footer:d(()=>[a("button",{disabled:s.isCreating,onClick:l[3]||(l[3]=e=>(t.status="trashed",s.save()))},r(s.translate("Move to trash")),9,et),s.isCreating?(i(),n("button",{key:0,onClick:l[4]||(l[4]=(...e)=>s.save&&s.save(...e))},r(s.translate("Create")),1)):(i(),n("button",{key:1,onClick:l[5]||(l[5]=(...e)=>s.save&&s.save(...e))},r(s.translate("Update")),1))]),default:d(()=>[a("div",Y,[l[11]||(l[11]=a("div",{class:"icon"},[a("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[a("path",{d:"M9 6a3 3 0 0 1 3-3h0a3 3 0 0 1 3 3h0a3 3 0 0 1-3 3h0a3 3 0 0 1-3-3m3 3v12",style:{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"}})])],-1)),a("label",null,r(s.translate("Status"))+":",1),h(a("select",{"onUpdate:modelValue":l[2]||(l[2]=e=>t.status=e)},[(i(!0),n(c,null,f(t.taxonomyFields?.find(e=>e.field.slug==="status")?.field?.options?.choices||[],e=>(i(),n("option",{value:e},r(e),9,Z))),256))],512),[[T,t.status]])]),a("div",$,[l[12]||(l[12]=a("div",{class:"icon"},[a("svg",{width:"15px",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 338.784 338.784","xml:space":"preserve"},[a("path",{d:"M18.93 168.462C18.93 85.497 86.427 18 169.392 18c41.483 0 80.871 17.046 109.254 47.017h-7.688a9 9 0 0 0-9 9 9 9 0 0 0 9 9h30.522a9 9 0 0 0 9-9V43.494c0-4.971-4.029-9-9-9s-9 4.029-9 9v9.971C260.649 19.401 216.217 0 169.392 0 76.502 0 .93 75.572.93 168.462c0 40.967 14.882 80.454 41.903 111.188a8.98 8.98 0 0 0 6.763 3.057 8.97 8.97 0 0 0 5.938-2.241 9 9 0 0 0 .816-12.702c-24.13-27.446-37.42-62.712-37.42-99.302m308.191-59.294a9 9 0 1 0-16.848 6.336c6.357 16.905 9.581 34.723 9.581 52.958 0 82.965-67.497 150.461-150.462 150.461-24.007 0-47.843-5.792-69.014-16.738l8.134-2.88a9 9 0 0 0-6.009-16.967l-28.771 10.189a9 9 0 0 0-5.479 11.488l10.189 28.771a9 9 0 0 0 8.483 5.998 9 9 0 0 0 8.484-12.007l-2.993-8.45c23.641 12.16 50.217 18.596 76.976 18.596 92.891 0 168.462-75.571 168.462-168.461 0-20.406-3.611-40.356-10.733-59.294"}),a("path",{d:"M169.392 56.371c-61.132 0-110.866 49.734-110.866 110.866s49.734 110.866 110.866 110.866 110.866-49.734 110.866-110.866c.001-61.132-49.734-110.866-110.866-110.866m85.112 119.866h7.317c-4.255 44.037-39.392 79.174-83.429 83.429v-7.317a9 9 0 0 0-9-9 9 9 0 0 0-9 9v7.317c-44.037-4.255-79.174-39.392-83.429-83.428h7.317c4.971 0 9-4.029 9-9s-4.029-9-9-9h-7.317c4.255-44.037 39.392-79.174 83.429-83.429v7.317a9 9 0 0 0 9 9 9 9 0 0 0 9-9v-7.317c44.037 4.255 79.174 39.392 83.429 83.428h-7.317a9 9 0 0 0-9 9 9 9 0 0 0 9 9"}),a("path",{d:"M209.864 167.286h-31.472v-48.79a9 9 0 0 0-9-9 9 9 0 0 0-9 9v57.79a9 9 0 0 0 9 9h40.472c4.971 0 9-4.029 9-9s-4.029-9-9-9"})])],-1)),a("label",null,r(s.translate("Revisions"))+":",1),a("button",{disabled:s.isCreating},r(s.translate("Browse")),9,tt)])]),_:1}),s.featuredImage?(i(),g(v,{key:0},{header:d(()=>[a("h2",null,r(s.translate("Featured image")),1)]),footer:d(()=>[...l[13]||(l[13]=[])]),default:d(()=>[(i(),g(p(s.getControl("media")),{large:!0,modelValue:t.obj.featured_image,"onUpdate:modelValue":l[6]||(l[6]=e=>t.obj.featured_image=e),postType:o.slug,field:s.featuredImage.field,priority:s.featuredImage.priority,source:s.featuredImage.source,item:t.obj},null,8,["modelValue","postType","field","priority","source","item"]))]),_:1})):y("",!0)])]),(i(),g(U,{to:"body"},[t.fileupload?(i(),g(p(s.getControl("mediaselector")),{key:0,postType:"attachments",field:t.field,priority:t.priority,source:t.source,item:t.item,multi:!1,onClose:l[7]||(l[7]=e=>t.fileupload=!1)},null,40,["field","priority","source","item"])):y("",!0)]))]))}const nt=x(_,[["render",st],["__scopeId","data-v-a53c5734"]]);export{nt as default};
