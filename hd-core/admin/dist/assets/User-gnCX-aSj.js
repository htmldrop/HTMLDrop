import{C as U}from"./Card-D1Gzf6wj.js";import{_ as T,b as a,e as l,p as h,d as y,q as c,F as v,g as r,t as o,s as d,v as p,l as w,h as f,w as n,k as j,f as b,y as k}from"./index-BnPcJEra.js";const S={components:{Card:U},inject:["translate","apiBase","apiFetch","navTree","controls","getControl"],props:["sub"],data:()=>({slug:"users",postTypeFields:[],title:"",newSlug:"",status:"active",obj:{}}),created(){this.init()},computed:{node(){const e=this.navTree?.find(i=>i.slug===this.slug);return this.sub&&e?.children?.find(i=>i.slug===this.sub)||e},isCreating(){return this.sub==="new"},picture(){return this.postTypeFields?.find(e=>e.field.slug==="picture"&&e.field.type==="media")}},watch:{slug(){this.init()},sub(){this.init()}},methods:{async init(){this.postTypeFields=[{field:{parent_slug:this.slug,name:"Username",slug:"username",type:"text",revisions:!1,required:!0,priority:10,order:1e3},priority:10,source:"runtime"},{field:{parent_slug:this.slug,name:"First name",slug:"first_name",type:"text",revisions:!1,required:!1,priority:10,order:1100},priority:10,source:"runtime"},{field:{parent_slug:this.slug,name:"Middle name",slug:"middle_name",type:"text",revisions:!1,required:!1,priority:10,order:1200},priority:10,source:"runtime"},{field:{parent_slug:this.slug,name:"Last name",slug:"last_name",type:"text",revisions:!1,required:!1,priority:10,order:1300},priority:10,source:"runtime"},{field:{parent_slug:this.slug,name:"Email",slug:"email",type:"text",revisions:!1,required:!1,priority:10,order:1400},priority:10,source:"runtime"},{field:{parent_slug:this.slug,name:"Phone",slug:"phone",type:"text",revisions:!1,required:!1,priority:10,order:1500},priority:10,source:"runtime"},{field:{parent_slug:this.slug,name:"Locale",slug:"locale",type:"text",revisions:!1,required:!1,priority:10,order:1600},priority:10,source:"runtime"},{field:{parent_slug:this.slug,name:"Email verified at",slug:"email_verified_at",type:"text",revisions:!1,required:!1,priority:10,order:1700},priority:10,source:"runtime"},{field:{parent_slug:this.slug,name:"Phone verified at",slug:"phone_verified_at",type:"text",revisions:!1,required:!1,priority:10,order:1800},priority:10,source:"runtime"},{field:{parent_slug:this.slug,name:"Status",slug:"status",options:{choices:["active","inactive"]},type:"select",revisions:!1,required:!1,priority:10,order:1900},priority:10,source:"runtime"},{field:{parent_slug:this.slug,name:"Picture",slug:"picture",type:"media",revisions:!1,required:!1,priority:10,order:2e3},priority:10,source:"runtime"},{field:{parent_slug:this.slug,name:"Password",slug:"password",type:"password",revisions:!1,required:!1,priority:10,order:2e3},priority:10,source:"runtime"}],this.title="",this.newSlug="",this.status="active",this.obj={},await Promise.all([this.getPost()]),this.isCreating&&(this.newSlug="")},async getPost(){if(!this.slug||this.isCreating)return;const e=await this.apiFetch(`${this.apiBase}/api/v1/${this.slug}/${this.sub}`);this.asign(await e.json())},async save(){try{if(this.obj?.id){const{password:e,...i}=this.obj;e&&(i.password=e);const g=await this.apiFetch(`${this.apiBase}/api/v1/${this.slug}/${this.obj.id}`,{method:"PATCH",body:JSON.stringify({...i,title:this.title,slug:this.newSlug})});this.asign(await g.json()),this.obj.slug&&this.obj.slug!==this.slug?this.$router.push("/"+this.slug+"/"+this.obj.slug):!this.obj.slug&&this.obj.id!==this.slug&&this.$router.push("/"+this.slug+"/"+this.obj.id)}else{const e=await this.apiFetch(`${this.apiBase}/api/v1/${this.slug}`,{method:"POST",body:JSON.stringify({title:this.title,slug:this.newSlug,...this.obj})});this.asign(await e.json()),this.$router.push("/"+this.slug+"/"+(this.obj.slug||this.obj.id))}}catch(e){console.error(e),alert(`Something went wrong: ${e.message}`)}},asign(e){this.newSlug=e.slug,this.title=e.title,this.obj=Object.fromEntries(Object.entries(e))}}},F={key:1,style:{padding:"20px 20px 50px"}},q={style:{margin:"0 0 20px"}},P={class:"wrapper"},B={class:"content"},N={key:0,class:"title"},L=["placeholder"],M={key:1,class:"slug"},O=["placeholder"],E={class:"permalink"},D={style:{width:"15px","margin-right":"5px"},xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 52 52","xml:space":"preserve"},H={class:"grid"},J={class:"fields"},A={class:"field"},G=["onUpdate:modelValue"],I=["onUpdate:modelValue"],z=["onUpdate:modelValue"],K=["onUpdate:modelValue"],Q=["onUpdate:modelValue"],R=["onUpdate:modelValue"],W=["value"],X={key:7},Y={class:"grid"},Z={class:"publish-row"},x=["value"],$=["disabled"];function ee(e,i,g,te,se,s){const _=j("router-link"),m=j("card");return s.node?.vue_instance?(l(),a(v,{key:0},[g.sub&&s.navTree?(l(),h(c("drop-"+e.slug+"-"+g.sub),{key:0,slug:e.slug,sub:g.sub},null,8,["slug","sub"])):s.navTree?(l(),h(c("drop-"+e.slug),{key:1,slug:e.slug,sub:g.sub},null,8,["slug","sub"])):y("",!0)],64)):(l(),a("div",F,[r("h1",q,o(s.isCreating?s.translate("New"):s.translate("Update"))+" "+o(s.translate("user")),1),r("div",P,[r("div",B,[e.postTypeFields?.find(t=>t.field.slug==="title")?(l(),a("div",N,[d(r("input",{placeholder:s.translate("Title"),"onUpdate:modelValue":i[0]||(i[0]=t=>e.title=t)},null,8,L),[[p,e.title]])])):y("",!0),e.postTypeFields?.find(t=>t.field.slug==="slug")?(l(),a("div",M,[d(r("input",{placeholder:s.translate("Slug"),"onUpdate:modelValue":i[1]||(i[1]=t=>e.newSlug=t)},null,8,O),[[p,e.newSlug]])])):y("",!0),r("div",E,[w(o(s.translate("Permalink"))+": ",1),i[7]||(i[7]=r("a",{href:"https://",target:"_blank"},"https://",-1))]),r("div",null,[f(_,{class:"button",to:"/users"},{default:n(()=>[(l(),a("svg",D,[...i[8]||(i[8]=[r("path",{d:"M48.6 23H15.4c-.9 0-1.3-1.1-.7-1.7l9.6-9.6c.6-.6.6-1.5 0-2.1l-2.2-2.2c-.6-.6-1.5-.6-2.1 0L2.5 25c-.6.6-.6 1.5 0 2.1L20 44.6c.6.6 1.5.6 2.1 0l2.1-2.1c.6-.6.6-1.5 0-2.1l-9.6-9.6c-.6-.7-.2-1.8.7-1.8h33.2c.8 0 1.5-.6 1.5-1.4v-3c0-.8-.6-1.6-1.4-1.6"},null,-1)])])),w(" "+o(s.translate("Go back to"))+" "+o(s.translate("Users")?.toLowerCase()),1)]),_:1})]),r("div",H,[f(m,null,{header:n(()=>[r("h2",null,o(s.translate("Fields")),1)]),footer:n(()=>[...i[9]||(i[9]=[])]),default:n(()=>[r("div",J,[(l(!0),a(v,null,b(e.postTypeFields?.filter(t=>!["slug","title","picture","status"].includes(t.field.slug)),({field:t,priority:V,source:C})=>(l(),a("div",A,[r("label",null,o(s.translate(t.name))+" "+o(t.required?"*":""),1),t.type==="text"?d((l(),a("input",{key:0,"onUpdate:modelValue":u=>e.obj[t.slug]=u},null,8,G)),[[p,e.obj[t.slug]]]):t.type==="number"?d((l(),a("input",{key:1,type:"number","onUpdate:modelValue":u=>e.obj[t.slug]=u},null,8,I)),[[p,e.obj[t.slug]]]):t.type==="password"?d((l(),a("input",{key:2,type:"password","onUpdate:modelValue":u=>e.obj[t.slug]=u},null,8,z)),[[p,e.obj[t.slug]]]):t.type==="editor"?d((l(),a("textarea",{key:3,"onUpdate:modelValue":u=>e.obj[t.slug]=u},null,8,K)),[[p,e.obj[t.slug]]]):t.type==="textarea"?d((l(),a("textarea",{key:4,"onUpdate:modelValue":u=>e.obj[t.slug]=u},null,8,Q)),[[p,e.obj[t.slug]]]):t.type==="select"?d((l(),a("select",{key:5,"onUpdate:modelValue":u=>e.obj[t.slug]=u},[(l(!0),a(v,null,b(t.options?.choices,u=>(l(),a("option",{value:u},o(u),9,W))),256))],8,R)),[[k,e.obj[t.slug]]]):s.controls?.find(u=>u.slug===t.type)?(l(),h(c(s.getControl(t.type)),{key:6,large:!0,postType:e.slug,modelValue:e.obj[t.slug],"onUpdate:modelValue":u=>e.obj[t.slug]=u,field:t,priority:V,source:C,item:e.obj},null,8,["postType","modelValue","onUpdate:modelValue","field","priority","source","item"])):(l(),a("div",X,"Unsupported field: "+o(t),1))]))),256))])]),_:1})])]),r("div",Y,[f(m,null,{header:n(()=>[r("h2",null,o(s.translate("Publish")),1)]),footer:n(()=>[r("button",{disabled:s.isCreating,onClick:i[3]||(i[3]=t=>(e.status="trashed",s.save()))},o(s.translate("Move to trash")),9,$),s.isCreating?(l(),a("button",{key:0,onClick:i[4]||(i[4]=(...t)=>s.save&&s.save(...t))},o(s.translate("Create")),1)):(l(),a("button",{key:1,onClick:i[5]||(i[5]=(...t)=>s.save&&s.save(...t))},o(s.translate("Update")),1))]),default:n(()=>[r("div",Z,[i[10]||(i[10]=r("div",{class:"icon"},[r("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M9 6a3 3 0 0 1 3-3h0a3 3 0 0 1 3 3h0a3 3 0 0 1-3 3h0a3 3 0 0 1-3-3m3 3v12",style:{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"}})])],-1)),r("label",null,o(s.translate("Status"))+":",1),d(r("select",{"onUpdate:modelValue":i[2]||(i[2]=t=>e.status=t)},[(l(!0),a(v,null,b(e.postTypeFields?.find(t=>t.field.slug==="status")?.field?.options?.choices||[],t=>(l(),a("option",{value:t},o(t),9,x))),256))],512),[[k,e.status]])])]),_:1}),f(m,null,{header:n(()=>[r("h2",null,o(s.translate("Categories")),1)]),footer:n(()=>[...i[11]||(i[11]=[])]),_:1}),s.picture?(l(),h(m,{key:0},{header:n(()=>[r("h2",null,o(s.translate("Picture")),1)]),footer:n(()=>[...i[12]||(i[12]=[])]),default:n(()=>[(l(),h(c(s.getControl("media")),{large:!0,modelValue:e.obj.picture,"onUpdate:modelValue":i[6]||(i[6]=t=>e.obj.picture=t),postType:e.slug,field:s.picture.field,priority:s.picture.priority,source:s.picture.source,item:e.obj},null,8,["modelValue","postType","field","priority","source","item"]))]),_:1})):y("",!0)])])]))}const re=T(S,[["render",ee],["__scopeId","data-v-1f88578f"]]);export{re as default};
